## <p align ="center"> ğŸ•°ï¸ Aiffel Thon </p>

## <p align ="center"> í”„ë¡œì íŠ¸ : ì¸ê³µì§€ëŠ¥ ë¹„ì„œë¥¼ ë§Œë“¤ì–´ë³´ì! </p> 

### <p align ="center"> ğŸ¤– Team ChatHuman ğŸ¤– </p> 

### <p align ="center"> íŒ€ì› </p>

 <p align ="center"> ğŸ¤¹â€â™‚ï¸ ë°©ìŠ¹ìš± ğŸš´â€â™‚ï¸ êµ¬ë³¸íšŒ ğŸŒï¸â€â™‚ï¸ ì´íƒœí™˜ â›·ï¸ ì¥ë¬¸ê·œ </p>

### <p align ="center"> ì´ í”„ë¡œì íŠ¸ëŠ” 22.12.26 ~ 23.02.08ì¼ê¹Œì§€ ì§„í–‰ë˜ëŠ” ì•„ì´í í†¤ í”„ë¡œì íŠ¸ ì…ë‹ˆë‹¤. </p>
---
 
### ì„¸ë¶€ ì¼ì •

|ìˆœì„œ|ê¸°ê°„|ì„¸ë¶€ ê³„íš|
|:---:|:---:|:---:|
|1ë²ˆ|22.12.26 ~ 22.12.30|íŒ€ì›ë“¤ê³¼ì˜ ê³„íš ì¡°ìœ¨|
|2ë²ˆ|23.01.02 ~ 23.02.03|ë°ì´í„° ì „ì²˜ë¦¬ ë° ê°œë°œ í™˜ê²½ êµ¬ì¶•|
|3ë²ˆ|23.01.09 ~ 23.01.13|ëª¨ë¸ í…ŒìŠ¤íŠ¸|
|4ë²ˆ|23.01.09 ~ 23.02.03|ì›¹í˜ì´ì§€ êµ¬ì¶•|
|5ë²ˆ|23.01.16 ~ 23.01.20|ëª¨ë¸ ì—°êµ¬ ë° ì¸í¼ëŸ°ìŠ¤ ì½”ë“œ ì‘ì„±|
|6ë²ˆ|23.01.16 ~ 23.01.27|ëª¨ë¸ í•™ìŠµ|
|7ë²ˆ|23.01.18 ~ 23.02.03|ëª¨ë¸ ë‹¤ë“¬ê¸°|
|8ë²ˆ|23.02.06 ~ 23.02.07|ë°œí‘œ ì¤€ë¹„|
|9ë²ˆ|23.02.08|ë°œí‘œ|
 
---
### ê°œìš”
- ì¼ìƒìƒí™œì— ë„ì›€ì„ ì£¼ë©° í˜„ì¬ ì¡´ì¬í•˜ëŠ” ì‹œë¦¬, í´ë¡œë²„, ì¹´ì¹´ì˜¤ì™€ ê°™ì€ ì¸ê³µì§€ëŠ¥ ë¹„ì„œì—ê²Œ ë¶€ì¬ëœ ê¸°ëŠ¥ì„ íƒ‘ì¬í•˜ëŠ”ê²ƒì„ ëª©í‘œë¡œ í•¨.
  - ë¶€ì¬ëœ ê¸°ëŠ¥ì´ë¼í•¨ì€ ì¼ìƒëŒ€í™” ê¸°ëŠ¥ì— ì´ˆì ì„ ë§ì¶”ë©° ê·¸ ì™¸ì˜ ì‚¬ì†Œí•œ ê²ƒë“¤ì„ ì¶”ê°€í•´ë³¼ ì˜ˆì •.   
  
- ê¸°ë³¸ì ì¸ í˜•íƒœëŠ” ì±—ë´‡ í˜•íƒœì´ë©° ë‹¤ì–‘í•œ í‚¤ì›Œë“œë¥¼ í†µí•´ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•  ê²ƒ.

![service](https://github.com/Ukbang/Aiffel_thon/blob/main/images/service.png)

---

### Requirement
> Python 3.9.7
> 
> Transformer 4.11.3
>  
> Numpy 1.21.4
>  
> PyTorch 1.9.1+cu111

---

### Dataset
- AIHub ì—ì„œ ì œê³µí•˜ëŠ” ì£¼ì œë³„ í…ìŠ¤íŠ¸ ì¼ìƒìƒí™œ ë°ì´í„°ì™€ í•œêµ­ì–´ ëŒ€í™” ìš”ì•½ì„ ì´ìš©í•˜ì—¬ ë§Œë“¦.
- ë°ì´í„°í”„ë ˆì„ í˜•íƒœë¡œ í•œ ëŒ€í™”ì˜ ë§ë­‰ì¹˜ë¥¼ Conversation columnìœ¼ë¡œ êµ¬ë¶„í•˜ê³  ê° ëŒ€í™” ê°„ ë°œí™”ìë¥¼ `'<usr>'`, `'<sys>'` í† í°ìœ¼ë¡œ êµ¬ë¶„í•˜ì˜€ìŒ.
- ì•½ 19ë§Œê°œì˜ ëŒ€í™”ë¥¼ ì´ìš©í•¨. 

![data_image](https://github.com/Ukbang/Aiffel_thon/blob/main/images/data_image.jpeg)

---
### ì „ì²˜ë¦¬ ë°©ì‹
- modules/preprocessing.py íŒŒì¼ì˜ clear_sentence í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì²˜ë¦¬.
- #@ì´ë¦„#ì€ make_name í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ëœë¤í•œ ì´ë¦„ì„ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŒ.
- @URL, #@ì‹œìŠ¤í…œ#ì‚¬ì§„#, #@ì´ëª¨í‹°ì½˜#ì€ ì‚­ì œí•˜ì˜€ê³  ë°˜ë³µë˜ëŠ” ã…‹,ã…,ã…œ,ã… ,. ê³¼ ê°™ì€ ë¬¸ìëŠ” 2ê°œë¡œ í†µì¼í•˜ì˜€ìœ¼ë©° ìì£¼ ë“±ì¥í•˜ëŠ” í‚¤í‚¤ ëŠ” ã…‹ã…‹ ë¡œ ë³€ê²½í•˜ì˜€ìŒ.

![make_name](https://github.com/Ukbang/Aiffel_thon/blob/main/images/make_name.jpeg)
![clear_sentence](https://github.com/Ukbang/Aiffel_thon/blob/main/images/clear_sentence.jpeg)

---

### ëª¨ë¸
- ëª¨ë¸ì€ ğŸ¤—Hugging Faceì—ì„œ ì œê³µí•˜ëŠ” gpt2 ëª¨ë¸ì„ ì‚¬ìš©í•˜ì˜€ìŒ.
- ë² ì´ìŠ¤ ëª¨ë¸ë¡œ ['skt/kogpt2-base-v2'](https://github.com/SKT-AI/KoGPT2) ì„ ì‚¬ìš©í•¨.   
 
 
<p align ="center"><img src="/images/gpt2.png" width="800px" height="300px"></p>

---
### í•™ìŠµ ì§„í–‰ê³¼ì • ë¦¬ë”ë³´ë“œ
#### Data type
__Topic = 250000ê°œ__
 
 __Topic+kakao Data = 190000ê°œ ('`<usr>`ë¡œ ëë‚˜ëŠ” ë¬¸êµ¬ ì‚­ì œ', ê¸¸ì´ 256')__
 
__kakao Data = 65000ê°œ__

---

#### Label

__Input = Inputê³¼ Labelì´ ë™ì¼__
 
 
__-100 = ë§ˆì§€ë§‰ `<sys>` ëŒ€í™”ë¥¼ ì œì™¸í•œ -100ì„ ì´ìš©í•œ Masking__

__-100+sys = ëª¨ë“  `<sys>` ëŒ€í™”ë¥¼ ì œì™¸í•œ ëª¨ë“  ëŒ€í™” -100ìœ¼ë¡œ Masking__
 
 
__Shift = Inputì€ `<s>` í† í°ì„ bos_tokenìœ¼ë¡œ ì‚¬ìš©, Labelì€ `</s>`í† í°ì„ eos_tokenìœ¼ë¡œ ì‚¬ìš©í•¨.__

|index|Model|Epochs|Data type|ì§„í–‰ ìƒí™©|ì§„í–‰ ì¼ì‹œ|Label|Loss|Val_Loss|Comment|ì„±ëŠ¥|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|1|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-01-31|-100|4.290 -> 3.797 -> 3.340 -> 2.803 -> 2.195|3.821 -> 3.759 -> 3.804 -> 3.938 -> 4.143|ë‹¨ë‹µí˜•ì´ê³  ëŒ€í™”ê°€ ì˜ ì´ë£¨ì–´ ì§€ì§€ ì•ŠìŒ.|[Link](https://github.com/Ukbang/Aiffel_thon/blob/main/chatbot/Test/23-02-01_-100_test.ipynb)|
|2|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-02-01|Input|1.476 -> 1.343 -> 1.270 -> 1.203 -> 1.137|1.486 -> 1.445 -> 1.434 -> 1.441 -> 1.461|í˜„ì¬ê¹Œì§€ ê°€ì¥ Best|[Link](https://github.com/Ukbang/Aiffel_thon/blob/main/chatbot/Test/23-02-01_True_test.ipynb)|
|3|skt/kogpt2-base-v2|3|kakao Data|Done|2023-01-30|Input|2.330 -> 2.147 -> 2.084|1.765 -> 1.723 -> 1.704|ë¬¸ì¥ ìƒì„±ì„ eos token ë°–ì— ëª»í•¨.|[Link](https://github.com/Ukbang/Aiffel_thon/blob/main/chatbot/Test/Inference_code_label_True_len384.ipynb)|
|4|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-02-01|shift|2.140 -> 2.005 -> 1.931 -> 1.864 -> 1.794|2.298 -> 2.236 -> 2.215 -> 2.221 -> 2.246|í•™ìŠµì´ ì „í˜€ ë˜ì§€ ì•Šì•˜ìŒ. íê¸°|[Link]()|
|5|skt/kogpt2-base-v2|10|Topic+kakao|Done|2023-02-01|Input|1.483 -> 1.352 -> 1.275 -> 1.206 -> 1.135 -> 1.062 -> 0.986 -> 0.908 -> 0.830 -> 0.753|1.504 -> 1.469 -> 1.456 -> 1.463 -> 1.485 -> 1.517 -> 1.562 -> 1.616 -> 1.683 -> 1.759|5epoch ì´ìƒë¶€í„° í•™ìŠµì´ ì˜¤íˆë ¤ ì•ˆë¨. íê¸°|[Link]()|
|6|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-02-05|Input|1.479 -> 1.380 -> 1.330 -> 1.292 -> 1.260|1.401 -> 1.370 -> 1.357 -> 1.350 -> 1.346|ìì˜í•œ ì½”ë“œ ìˆ˜ì •í›„ í•™ìŠµí•˜ì˜€ìŒ. 2ë²ˆê³¼ ì„±ëŠ¥ì´ ë™ì¼í•¨.|[Link]()|
|7|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-02-05|-100|4.269 -> 3.869 -> 3.574 -> 3.296 -> 3.031|4.069 -> 3.997 -> 3.989 -> 4.032 -> 4.106|.....|[Link]()|
|8|skt/kogpt2-base-v2|5|Topic+kakao|Done|2023-02-05|-100+sys|3.826 -> |3.352 -> |.....|[Link]()|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|

---

### ì¶”ê°€ëœ ì„œë¹„ìŠ¤
<p align ="center"><img src="/images/service_message.png" width="600px" height="900px"></p>

---

### íšŒê³ 
-

---
### ì°¸ê³  ë¬¸í—Œ
1. [songys/AwesomeKorean_Data: í•œêµ­ì–´ ë°ì´í„° ì„¸íŠ¸ ë§í¬](https://github.com/songys/AwesomeKorean_Data)
2. [ììœ ëŒ€í™”í˜•ì‹ì˜ ìŒì„± ë°ì´í„°](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=109)
3. [STTëª¨ë¸ ë° TTSëª¨ë¸ ê°œë°œ](https://www.youtube.com/watch?v=WTul6LIjIBA)
4. [ì˜¨ë¼ì¸ êµ¬ì–´ì²´ ë§ë­‰ì¹˜ ë°ì´í„°](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=625)
5. [ë²•ë¥  ì§€ì‹ ë² ì´ìŠ¤](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=99)
6. [íŒŒì´ì¬ìœ¼ë¡œ JSON íŒŒì¼ ë‹¤ë£¨ê¸°](https://www.youtube.com/watch?v=s9D-JIuaFqY&t=433s)
7. [korean SmileStyle Dataset](https://www.google.com/url?q=https://github.com/smilegate-ai/korean_smile_style_dataset&sa=D&source=docs&ust=1672048006339662&usg=AOvVaw2KWZl71R1gdPiznFcT1tkG)
8. [ì£¼ì œë³„ í…ìŠ¤íŠ¸ ì¼ìƒìƒí™œ ë°ì´í„°](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&dataSetSn=543)
9. [í•œêµ­ì–´ ëŒ€í™” ìš”ì•½](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=117)
10. [í—ˆê¹…í˜ì´ìŠ¤ ëª¨ë¸](https://huggingface.co/lcw99/ko-dialoGPT-korean-chit-chat)
11. [[NLP] ì–¸ì–´ëª¨ë¸ì˜ í‰ê°€ì§€í‘œ 'Perplexity' ê°œë… ë° ê³„ì‚°ë°©ë²•](https://heytech.tistory.com/344)
12. [ë¬´ìŠ¨ ëŒ€í™”ë“  í•  ìˆ˜ ìˆëŠ” ì—ì´ì „íŠ¸ë¥¼ í–¥í•˜ì—¬](https://brunch.co.kr/@synabreu/35)
13. [PyTorch 2.0 ë¬´ì—‡ì´ ë‹¤ë¥¸ê°€?](https://blog.naver.com/october-eight/222948663006)
14. [Tensorflow_KoGPT2_Chabot](https://github.com/ukairia777/tensorflow-kogpt2-chatbot/blob/main/KoGPT2_Chatbot.ipynb)
15. [GPT-2 Fine Tuning ](https://blog.naver.com/ds_penaut/222699897818)
16. [CaFeCoKe/KoGPT2_Chatbot](https://github.com/CaFeCoKe/KoGPT2_Chatbot)
---
### íŒ€ì› ê¹ƒí—ˆë¸Œ ë§í¬

- [ë°©ìŠ¹ìš±](https://github.com/Ukbang)
- [êµ¬ë³¸íšŒ](https://github.com/HughBGrant) 
- [ì´íƒœí™˜](https://github.com/leetaehwan) 
- [ì¥ë¬¸ê·œ](https://github.com/fmfmsd)

---
### Google Drive
- [êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§í¬](https://drive.google.com/drive/folders/13xvDPcMMqEe8cVTOg3VBjc0IgSjOAX9E)


 
